"use strict";var m2d2=(function(){var b=function(d,e){if(e!=undefined){d.onRenderDone=e}return new a(d).get()};b.ext=function(d){a.prototype._ext=c(a.prototype._ext,d)};var a=function(e){var d=this;if(!(d instanceof a)){d=new a(e);return d}else{d=c(d,e||{});if(d.auto_init){d.init()}}};a.prototype={root:"body",auto_init:true,html:true,data:{},interval:0,preRender:function(d){},beforeDataRender:function(d,e,f){},afterDataRender:function(d,e,f){},postRender:function(d){},onRenderDone:function(d){},rendered:false,$root:null,init:function(){var d=this;d.$root=$(this.root);d.cache=d.$root.html();if($.isFunction(d._data)){d._func=d._data;d._data=$.isArray(d._data)?[]:{};d._doFunc(d._func,d.param,function(f,e){if(e==undefined){if(d.interval*1>0){e=d.interval}}if(e*1>0){d.interval=setInterval(function(){d._func(function(g){d._doRender(d.$root,g)})},e)}d.render()})}else{if(typeof this._data!="object"){this._data={text:this._data}}d.render()}},update:function(f,e,d){var h=this;if(h.rendered){var g=function(i){if(i._node!=undefined){var j={};j[e]=d.value;h._doRender(i._node,c(i,j))}else{h.clear();h._doRender(h.$root,i)}};if(e==undefined&&$.isFunction(h._func)){h._doFunc(h._func,f,function(i){g(i)})}else{g(f)}}},render:function(){var d=this;d.preRender(this);d._doRender(d.$root,d._data);d.postRender(this);d.rendered=true;d.onRenderDone(d.get())},get:function(){var d=this;if($.isFunction(d._data)){d._data={}}d._defineProp(d._data,"m2d2",this);return this._data},clear:function(){var d=this;if(d.rendered){d.$root.html(d.cache)}},getID:function(){var d=this;return d.$model.data("id")},_cache:null,_data:null,_func:null,_ext:{},_htmlGenTags:["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","datalist","dd","del","details","dfn","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","map","mark","menu","meter","nav","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","samp","section","select","small","span","strong","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","tr","tt","ul","var"],_cloneData:function(){return JSON.parse(JSON.stringify(this._data))},_doFunc:function(d,e,g){var f=this;d(function(i,h){if(typeof i=="object"){if($.isArray(i)&&$.isPlainObject(f._data)){f._data=i}else{for(var j in i){f._data[j]=i[j]}}}if(g!=undefined){g(i,h)}},e)},_doRender:function(d,e){var f=this;if(f._data._proxy==undefined&&($.isPlainObject(f._data)||$.isArray(f._data))){f._data=f._proxy(f._data,function(i,g,h){if(g!="m2d2"&&g[0]!="_"){f.update(i,g,h)}})}if($.isArray(e)){f._doArray(d,f,e)}else{f._setValues(d,e)}},_doArray:function(f,j,e){var k=this;var h=k._getTemplate(f,j);if(h){for(var g=0;g<e.length;g++){if(e[g]._node!=undefined){e[g]._node=undefined}var d=$(h);d.data("id",g);f.append(d);k._setValues(d,e[g])}}else{console.log("No template found to apply array:");console.log(j)}},_getTemplate:function(d,g){var h=this;if(g._template!=undefined){return g._template}else{var e;if(g.template!=undefined){if($.isPlainObject(g.template)){e=$("<div>");h._setValues(e,g.template)}else{e=$("<div>"+g.template+"</div>")}}else{e=d.find("template")}if(e.length){var f=e.html().trim();h._defineProp(g,"_template",f);return f}else{return d.html().trim()}}},_setValues:function(d,h){var j=this;if($.isPlainObject(h)){j._setNode(d,h);if(h.data!=undefined){j._doArray(d,h,h.data);return}if(h.template!=undefined){d.html(j._getTemplate(d,h))}for(var g in h){if(["template","data"].indexOf(g)==-1){if(j._ext[g]!=undefined&&$.isFunction(j._ext[g])){var f=j._ext[g](h[g],d);if(f){j._setValues(d,f)}}else{if(g[0]=="#"){j._doRender($(g),h[g])}else{if(g=="text"||g=="html"){j._setValue(d,g,h[g])}else{if(h[g] instanceof Date){j._setValue(d,g,h[g])}else{if(j._hasAttr(d,g)&&!(g=="id"&&$.isNumeric(h[g]))){d.attr(g,h[g])}else{var i=d.find(g);if(i.length==0){i=d.find("."+g);if(i.length==0){if(j._htmlGenTags.indexOf(g)!=-1){var e=$("<"+g+">");d.append(e);j._doRender(e,h[g])}else{if(!$.isNumeric(g)){d.attr(g,h[g])}}continue}}j._doRender(i,h[g])}}}}}}}}else{j._setValue(d,null,h)}},_setValue:function(d,f,h){var i=this;var g=f=="html"||(f==null&&!$.isNumeric(h)&&h.trim().indexOf("<")!==-1);if(g){d.html(h)}else{if(f=="value"||(f==null&&i._hasAttr(d,"value"))){if(i._hasAttr(d,"checked")){if(h==true||h=="true"||h==1){d.attr("checked",true)}else{if(h==false||h=="false"||h==0){d.attr("checked",false)}else{d.val(h)}}}else{if(h instanceof Date){d.get(0).valueAsDate=h}else{d.val(h)}}}else{if(d.children().length>0){var e=d.contents().filter(function(){return this.nodeType==3}).first();if(e.length){e.replaceWith(h)}else{d.html(d.html()+h)}}else{d.text(h)}}}},_hasAttr:function(e,d){var g=e.get(0);var f=false;if(!$.isNumeric(d)){switch(d){case"checked":f=(g.type!=undefined&&(g.type=="radio"||g.type=="checkbox"));break;default:f=g[d]!=undefined||g.hasAttribute(d)}}return f},_defineProp:function(e,f,d){if(typeof e=="object"){if(e[f]==undefined){Object.defineProperty(e,f,{enumerable:false,writable:true});e[f]=d}}},_setNode:function(d,e){this._defineProp(e,"_node",d)},_proxy:function(f,d){this._defineProp(f,"_proxy",true);var e={get:function(j,i,h){if(i=="m2d2"||i[0]=="_"){return j[i]}else{try{if($.isArray(f)&&!$.isNumeric(i)){return j[i]}else{return new Proxy(j[i],e)}}catch(g){return Reflect.get(j,i,h)}}},defineProperty:function(i,g,h){d(i,g,h);return Reflect.defineProperty(i,g,h)},deleteProperty:function(h,g){d(h,g);return Reflect.deleteProperty(h,g)},set:function(i,h,g){i[h]=g;d(i,h,{value:g});return true}};return new Proxy(f,e)},set data(d){var e=this;e._data=d;e.update(e._data)},get data(){var d=this;return d._data}};function c(){for(var e=1;e<arguments.length;e++){for(var d in arguments[e]){if(arguments[e].hasOwnProperty(d)){arguments[0][d]=arguments[e][d]}}}return arguments[0]}return b})();