/**
 * License: MIT
 * Generated on 2021-07-30
 * Author: A.Lepe (dev@alepe.com)
 * Version: 2.0.1
 */

"use strict";class Utils{isString(t){return"string"==typeof t}isBool(t){return"boolean"==typeof t}isNumeric(t){return!isNaN(parseFloat(t))&&isFinite(t)}isSelectorID(t){return 0===(t+"").trim().indexOf("#")}isPlainObject(t){return"Object"===t.constructor.name}isObject(t){return"object"==typeof t}isArray(t){return Array.isArray(t)}isFunction(t){return"function"==typeof t}isElement(t){return t instanceof HTMLElement}isNode(t){return t instanceof Node||t instanceof DocumentFragment}isHtml(t){return-1!==(t+"").trim().indexOf("<")}isEmpty(t){return void 0===t||this.isObject(t)&&0===Object.keys(t).length||""===t}cleanArray(t){return t.filter((function(t){return 0===t||t}))}isValidElement(t){const e=this.newElement(t);return"template"!==t&&"HTMLUnknownElement"!==e.constructor.name}exists(t){return null!==document.querySelector(t)}getAttrOrProp(t,e){let r="";return this.hasAttrOrProp(t,e)&&(r=this.hasAttr(t,e)?t.getAttribute(e):t[e]),r}hasAttrOrProp(t,e){return this.hasAttr(t,e)||this.hasProp(t,e)}hasAttr(t,e){let r=!1;if(t&&!this.isNumeric(e))switch(e){case"checked":r=void 0!==t.type&&("radio"===t.type||"checkbox"===t.type);break;default:r=void 0!==t.hasAttribute&&t.hasAttribute(e)}return r}hasProp(t,e){let r=!1;if(t&&!this.isNumeric(e)){let n=void 0!==t[e];n&&null===t[e]&&"value"===e&&(n=!1),r=n&&!(t[e]instanceof Node)&&!t.hasAttribute(e)}return r}setPropOrAttr(t,e,r){if(this.hasProp(t,e))try{t[e]=r}catch(n){this.setAttr(t,e,r)}else this.setAttr(t,e,r)}setAttr(t,e,r){r?t.setAttribute(e,r):t.removeAttribute(e)}defineProp(t,e,r){this.isObject(t)&&void 0===t[e]&&(Object.defineProperty(t,e,{enumerable:!1,writable:!0}),t[e]=r)}htmlElement(t){const e=this.newElement("template");return e.innerHTML=t.trim(),e.content.firstChild}newElement(t){return document.createElement(t)}newEmptyNode(){return new DocumentFragment}getMethods(t){const e=Reflect.getPrototypeOf(t),r=Reflect.getPrototypeOf(e);return Reflect.ownKeys(e).filter(t=>Reflect.ownKeys(r).indexOf(t)<0)}appendAllChild(t,e){for(;t.firstChild;)e.append(t.firstChild)}prependAllChild(t,e){for(;t.firstChild;)e.prepend(t.firstChild)}}
class m2d2{"use strict";_storedEvents=[];static storedEventsTimeout=50;static short=!0;static updates=!0;static utils=new Utils;constructor(){}static instance=new m2d2;static extensions={};static main=(()=>{const e=(e,t)=>this.instance.getProxyNode(e,t);return m2d2.utils.getMethods(m2d2.utils).forEach(t=>{e[t]=m2d2.utils[t]}),e})();static ready(e){document.addEventListener("DOMContentLoaded",()=>{e(m2d2.main)})}static load(e){if(void 0!==e){const t=e(m2d2.main);m2d2.utils.isObject(t)&&!m2d2.utils.isEmpty(t)&&Object.keys(t).forEach(e=>{if(m2d2.utils.isValidElement(e)){void 0===m2d2.extensions[e]&&(m2d2.extensions[e]={});const s=m2d2.utils.newElement(e);Object.keys(t[e]).forEach(t=>{m2d2.utils.hasProp(s,t)&&console.log("Warning: property ["+t+"] already exists in node: ["+e+"] while trying to extend it. Unexpected behaviour may happen.")}),Object.assign(m2d2.extensions[e],t[e])}else{void 0===m2d2.extensions["*"]&&(m2d2.extensions["*"]={});const s=m2d2.utils.newElement("div");Object.keys(t[e]).forEach(e=>{m2d2.utils.hasProp(s,e)&&console.log("Warning: property ["+e+"] already exists in Node while trying to extend it. Unexpected behaviour may happen.")}),Object.assign(m2d2.extensions["*"],t[e])}})}return m2d2.main}extDom(e,t){if(!e)return console.error("Selector was empty"),null;void 0===t&&(t=document);const s=m2d2.utils.isNode(e)?e:t.querySelector(e);if(!s)return m2d2.utils.isString(e)?(console.error("Selector: "+e+" didn't match any element in node:"),console.log(t)):console.error("Node was null"),null;if(void 0===s._m2d2){s._m2d2=!0,["parent","sibling","find","findAll","onupdate","show","onshow","css","text","html","getData"].forEach(e=>{s.hasOwnProperty(e)&&(console.log("Node already had ["+e+"] property. It might cause unexpected behaviour."),console.log("You may need to update the M2D2 version or report it to: github.com/lepe/m2d2/"))}),Object.defineProperty(s,"text",{get(){return this.childNodes.length?this.innerText:this.textContent},set(e){if(this.childNodes.length){let t=!1;this.childNodes.forEach(s=>{"Text"===s.constructor.name&&(s.nodeValue=e,t=!0)}),t||this.prepend(document.createTextNode(e))}else this.textContent=e}}),Object.defineProperty(s,"html",{get(){return this.innerHTML},set(e){this.innerHTML=e}}),Object.defineProperty(s,"css",{get(){return this.classList},set(e){m2d2.utils.isArray(e)?this.className=e.join(" "):m2d2.utils.isString(e)?this.className=e:m2d2.utils.isPlainObject(e)?Object.keys(e).forEach(t=>{e[t]?this.classList.add(t):this.classList.remove(t)}):console.error("Trying to assign a wrong value to css : "+e)}}),Object.defineProperty(s,"show",{get(){const e=this.getBoundingClientRect(),t="none"!==this.style.display,s="hidden"!==this.style.visibility;return t&&s&&e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)},set(e){const t=()=>getComputedStyle(this,null).display,s=()=>{const e=document.getElementsByTagName("body")[0],t=document.createElement("template"),s=document.createElement(this.tagName);t.append(s),e.append(t);const i=getComputedStyle(s,null).display;return t.remove(),i};if(e){if("none"===t()){if(this._m2d2_display)this.style.display=this._m2d2_display;else if(this.style.removeProperty("display"),"none"===t()){const e=s();this.style.display=this.dataset.display||("none"!==e?e:"block")}void 0!==this.onshow&&m2d2.utils.isFunction(this.onshow)&&this.onshow(this)}}else{const e="none"!==this.style.display?this.style.display:t();"none"!==e&&(this._m2d2_display=e),this.style.display="none"}}});let e={};return void 0!==m2d2.extensions["*"]&&Object.assign(e,m2d2.extensions["*"]),void 0!==m2d2.extensions[s.tagName]&&Object.assign(e,m2d2.extensions[s.tagName]),Object.assign(s,{parent:()=>this.extDom(s.parentElement),sibling:e=>s.parentElement.find(e),find:e=>{const t=s.querySelector(e);return t?this.extDom(t):null},findAll:e=>{const t=void 0===e?Array.from(s.children):s.querySelectorAll(e);return t.forEach(e=>{this.extDom(e)}),t}},e),["INPUT","TEXTAREA","SELECT"].indexOf(s.tagName)>=0&&m2d2.utils.hasAttrOrProp(s,"value")&&(s.oninput=function(){this.setAttribute("value",this.value)}),"FORM"===s.tagName&&(s.getData=function(){const e={},t=new FormData(this);for(let s of t.entries())""!==s[1]&&(e[s[0]]=s[1]);return e}),s}return s}doDom(e,t){if(m2d2.utils.isObject(e)&&void 0===t&&(t=e,e="body"),!(m2d2.utils.isString(e)||m2d2.utils.isElement(e)||m2d2.utils.isNode(e)))return console.error("Selector is not a string or a Node:"),console.log(e),null;if(m2d2.utils.isString(e)&&!document.querySelector(e))return console.log("Selected element doesn't exists: "+e),null;const s=this.extDom(e);if(void 0===t)return s;if(t=this.plainToObject(s,t),Object.keys(t).filter(e=>!["tagName"].includes(e)).forEach(e=>{let i=t[e];null==i&&(console.log("Value was not set for key: "+e+", 'empty' was used in object: "),console.log(t),console.log("In node:"),console.log(s),i="");let n=m2d2.utils.hasProp(s,e),o=!1;if(m2d2.utils.hasAttr(s,e)||n)switch(!0){case"value"===e&&m2d2.utils.hasProp(s,"valueAsDate")&&i instanceof Date:e="valueAsDate";case"css"===e:case typeof i==typeof s[e]:case m2d2.utils.isString(s[e])&&m2d2.utils.isNumeric(i):case m2d2.utils.isFunction(i)&&m2d2.utils.isObject(s[e]):case m2d2.utils.isBool(i)&&m2d2.utils.isString(s[e]):case"object"==typeof s[e]&&"INPUT"===s.tagName:o=!0}if(o){let t=!1;switch(e){case"classList":m2d2.utils.isArray(i)?i.forEach(t=>{s[e].add(t)}):m2d2.utils.isString(i)?s[e].add(i):t=!0;break;case"style":case"dataset":m2d2.utils.isPlainObject(i)?Object.assign(s[e],i):t=!0;break;default:switch(!0){case m2d2.utils.isBool(i):case m2d2.utils.hasAttrOrProp(s,e):m2d2.utils.setPropOrAttr(s,e,i);break;default:s[e]=i}}t&&(console.error("Invalid value passed to '"+e+"': "),console.log(i),console.log("Into Node:"),console.log(s))}else{const n=[];try{if("template"!==e&&!m2d2.utils.isFunction(i)){if(e&&e.match(/^\w/)){let t=s.find("#"+e);t&&-1===n.indexOf(t)&&n.push(t),t=s.find("[name="+e+"]"),t&&-1===n.indexOf(t)&&n.push(t);const i=Array.from(s.findAll("."+e)).filter(e=>n.indexOf(e)<0);i.length>0&&i.forEach(e=>n.push(e))}const t=Array.from(s.findAll(e)).filter(e=>n.indexOf(e)<0);t.length>0&&t.forEach(e=>n.push(e))}}catch(t){return console.error("Invalid selector: "+e),void console.log(t)}if(n.length>1){const t=[];n.forEach(s=>{t.push(this.render(s,e,i))}),this.linkNode(s,e,t),void 0!==i.warn&&!1===i.warn||(console.log("Multiple elements were assigned with key: ["+e+"] under node: "),console.log(s),console.log("It might be what we expect, but if it is not expected it could result on some elements mistakenly rendered. You can specify 'warn : false' under that element to hide this message."))}else if(1===n.length){const o=n[0];if(m2d2.utils.isElement(o))if(m2d2.utils.isArray(i)){const n=t.template;this.doItems(o,i,n),this.linkNode(s,e,o)}else this.renderAndLink(s,o,e,i);else console.error("BUG: It should have been a node but got: "),console.log(o),console.log("Parent node:"),console.log(s)}else if(0===n.length){"template"===e&&void 0===t.items&&(e="items",i=[]);const n=m2d2.utils.isFunction(i);if(void 0!==i.tagName){const t=this.appendElement(s,i.tagName);this.renderAndLink(s,t,e,i)}else if(m2d2.utils.isValidElement(e)&&!n){const t=this.appendElement(s,e);this.renderAndLink(s,t,e,i)}else if("items"===e){const e=t.template;if(m2d2.utils.isPlainObject(i)){const e=[];Object.keys(i).forEach(t=>{let n;"DL"===s.tagName?n={dt:t,dd:i[t]}:(n={text:i[t]},m2d2.utils.hasAttrOrProp(s,"value")?n.value=t:n.dataset={id:t}),e.push(n)}),i=e}m2d2.utils.isArray(i)?this.doItems(s,i,e):(console.log("Warning: 'items' specified but value is not and array, in element: "),console.log(s),console.log("Passed values are: "),console.log(i))}else n?m2d2.updates&&("onupdate"===e&&s.addEventListener(e,i,!0),s[e]=i):"template"!==e&&"warn"!==e&&!1!==i&&(void 0!==t.warn&&!1===t.warn||(console.error("Not sure what you want to do with key: "+e+" under element: "),console.log(s),console.log("And object:"),console.log(t),console.log("Most likely the element's property or child no longer exists or the value passed to it is incorrect."),console.log("You can set 'warn : false' property to the element to dismiss this message.")),s[e]=i)}}}),s.onload){const e=["BODY","FRAME","IFRAME","IMG","LINK","SCRIPT","STYLE"].indexOf(s.tagName)>=0,t="INPUT"===s.tagName&&"image"===s.type;if(!e&&!t){const e=new CustomEvent("onload");s.addEventListener("onload",s.onload,!0),s.dispatchEvent(e)}}return s}plainToObject(e,t){return m2d2.utils.isPlainObject(t)||m2d2.utils.isFunction(t)||(m2d2.utils.isHtml(t)?t={html:t}:m2d2.utils.isArray(t)?t={items:t}:m2d2.utils.hasProp(e,"value")?t="SELECT"===e.tagName?{value:t,text:t}:{value:t}:m2d2.utils.isString(t)&&"IMG"===e.tagName?t={src:t}:(m2d2.utils.isString(t)||m2d2.utils.isNumeric(t))&&(t={text:t})),t}renderAndLink(e,t,s,i){const n=this.render(t,s,i);this.linkNode(e,s,n)}render(e,t,s){return s=this.plainToObject(e,s),this.doDom(e,s)}linkNode(e,t,s){if(e[t]===s){const i=this.proxy(s);try{e[t]=i}catch(e){}e["$"+t]=i}else m2d2.utils.hasAttrOrProp(e,t)?(e["$"+t]=s,console.log("Property : "+t+" existed in node: "+e.tagName+". Using $"+t+" instead for node: "+s.tagName+".")):e[t]=this.proxy(s)}appendElement(e,t){const s=m2d2.utils.newElement(t);return e.append(s),s}getItem(e,t,s,i){i||(i=this.getTemplate(e));const n=i.cloneNode(!0);this.addTemplatesToItem(i,n),n.dataset.id=t,this.setUniqueAttrib(n,"selected");let o=this.doDom(n,s);return this.getItemWithEvents(e,o)}addTemplatesToItem(e,t){["_template","__template"].forEach(s=>{void 0!==e[s]&&(t[s]=e[s])})}getItemWithEvents(e,t){if(void 0!==e.__template){const s=(e,t)=>(t=t||{},Object.keys(e).forEach(i=>{m2d2.utils.isPlainObject(e[i])?t[i]=s(e[i]):m2d2.utils.isFunction(e[i])&&(t[i]=e[i])}),t);let i=s(e.__template);m2d2.utils.isEmpty(i)||(i=i[Object.keys(i)[0]],t=this.doDom(t,i))}return t}doItems(e,t,s){const i=this.getTemplate(e,s);if(void 0===i)return console.error("Template not found. Probably an array is being used where it is not expected. Node:"),console.log(e),console.log("Value (mistaken?):"),void console.log(t);let n=0;t.forEach(t=>{t=this.plainToObject(e,t);const s=this.getItem(e,n++,t,i);s&&e.append(s)});const o=e.find("template");o&&e.removeChild(o),e.items=e.children,this.extendItems(e)}getTemplate(e,t){if(void 0!==e._template&&""!==e._template)return e._template;{let s;const i=e.querySelector("template");if(i)s=m2d2.utils.htmlElement(i.innerHTML.trim());else switch(e.tagName){case"SELECT":case"DATALIST":s=m2d2.utils.newElement("option");break;case"UL":case"OL":s=m2d2.utils.newElement("li");break;case"NAV":s=m2d2.utils.newElement("a");break;case"DL":s=m2d2.utils.newElement("dd");break;default:if(t){const i=Object.keys(t).length;if(i){if(i>1)if(void 0!==t.tagName){let e={};e[t.tagName]=t,t=e}else console.log("Template has more than one top elements. Using the first one. In: "),console.log(t),console.log("Node: "),console.log(e);const n=Object.keys(t)[0],o=t[n];m2d2.utils.isValidElement(n)?s=m2d2.utils.newElement(n):void 0!==o.tagName?s=m2d2.utils.newElement(o.tagName):(console.error("Template defined an element which can not be identified: ["+n+"], using <span> in:"),console.log(t),console.log("Node: "),console.log(e),s=m2d2.utils.newElement("span"))}else console.error("Template has no definition and it can not be guessed. Using <span>. Template: "),console.log(t),console.log("Node: "),console.log(e),s=m2d2.utils.newElement("span")}else e.childElementCount>0&&(s=m2d2.utils.htmlElement(e.innerHTML.trim()))}if(t)if(m2d2.utils.isPlainObject(t)){const i=m2d2.utils.newEmptyNode();i.append(s);s=this.doDom(i,t).children[0],m2d2.utils.defineProp(e,"__template",t)}else s=m2d2.utils.isHtml(t)?m2d2.utils.htmlElement(t):m2d2.utils.isSelectorID(t)?m2d2.utils.htmlElement(document.querySelector(t).innerHTML):m2d2.utils.newElement(t);if(s.childrenElementCount>1){console.log("Templates only supports a single child. Multiple children were detected, wrapping them with <span>. Template:"),console.log(s);const e=m2d2.utils.newElement("span");e.append(s),s=e}return s&&m2d2.utils.defineProp(e,"_template",s),s}}setUniqueAttrib(e,t){e.hasOwnProperty(t)||Object.defineProperty(e,t,{get:function(){return this.hasAttribute(t)},set:function(e){const s=this.parentNode?this.parentNode.find("["+t+"]"):null;s&&s.removeAttribute(t),m2d2.utils.setAttr(this,t,e)}})}getNode(e,t){return void 0===t&&(t=document),e instanceof Node?e:t.querySelector(e)}proxy(e,t){if(!m2d2.short||null===e||void 0!==e._proxy&&void 0===t)return e;e._proxy=e;return new Proxy(e,{get:(e,t,s)=>{const i=e[t];switch(!0){case null==i:return null;case"function"==typeof i:return i.bind(e);case i._proxy&&void 0!==e["$"+t]:return e["$"+t];case void 0===i._proxy&&m2d2.utils.isElement(i):return this.proxy(i);default:return i}},set:(e,t,s)=>{let i="";if(m2d2.utils.isElement(e[t])){let n="";m2d2.utils.isHtml(s)?n="html":m2d2.utils.hasAttrOrProp(e[t],"value")?n="value":m2d2.utils.isString(s)&&"IMG"===e[t].tagName?n="src":(m2d2.utils.isString(s)||m2d2.utils.isNumeric(s))&&(n="text"),n&&(i=e[t][n],e[t][n]=s)}else"onupdate"===t?m2d2.updates?m2d2.utils.isFunction(s)?(e.addEventListener("onupdate",s,!0),i=e[t],e[t]=s):(console.error("Value passed to 'onupdate' is incorrect, in node:"),console.log(e),console.log("Value: (not a function)"),console.log(s)):(console.log("Updates are not available when `m2d2.updates == false`:"),console.log(e)):"items"===t?(e.items.clear(),this.doItems(e,s)):(i=e[t],e[t]=s);return m2d2.updates&&void 0!==e.onupdate&&s!==i&&e.dispatchEvent(new CustomEvent("onupdate",{detail:{type:typeof s,property:t,newValue:s,oldValue:i}})),!0}})}onObserve(e,t){e.forEach(e=>{const t=e.target;if(!(this._storedEvents.indexOf(e)>=0)&&(this._storedEvents.push(e),setTimeout(()=>{const t=this._storedEvents.indexOf(e);t>=0&&this._storedEvents.splice(t,1)},m2d2.storedEventsTimeout),void 0!==t.onupdate))if("attributes"===e.type){const s=m2d2.utils.getAttrOrProp(t,e.attributeName);s!==e.oldValue&&t.dispatchEvent(new CustomEvent("onupdate",{detail:{type:typeof s,property:e.attributeName,newValue:s,oldValue:e.oldValue}}))}else if("childList"===e.type){if("#text"===(e.addedNodes[0]||e.removedNodes[0]).nodeName){const s=e.addedNodes[0].textContent,i=e.removedNodes[0].textContent;s!==i&&t.dispatchEvent(new CustomEvent("onupdate",{detail:{type:typeof s,property:"text",newValue:s,oldValue:i}}))}else if(void 0!==t.items){const s=e.addedNodes,i=e.removedNodes;s!==i&&t.dispatchEvent(new CustomEvent("onupdate",{detail:{type:typeof s,property:"items",newValue:s,oldValue:i}}))}}})}observe(e){if(m2d2.updates){const t=new MutationObserver(this.onObserve.bind(this)),s={attributeOldValue:!0,subtree:!0,childList:!0},i=e._proxy||e;t.observe(i,s)}}getProxyNode(e,t){const s=this.doDom(e,t);if(s)return this.observe(s),this.proxy(s)}extendItems(e){function t(t){t.forEach(t=>{const s=t.parentNode.removeChild(t);e.append(s)})}const s=e.items;Object.getOwnPropertyNames(Array.prototype).concat(["clear","get","remove","selected","first","last","findAll"]).forEach(i=>{if(void 0===s[i]){let n=null;const o=this;switch(i){case"copyWithin":case"fill":case"splice":n=function(){console.log("Not available yet: "+i)};break;case"reverse":n=function(...e){if(this.items.length){const s=Array.from(this.items),n=s[i](...e);return t(s),n}};break;case"clear":n=function(){for(;this.items[0];)this.items[0].remove()};break;case"get":n=function(e){let t=null;return this.items.length&&this.items.some(s=>{const i=m2d2.utils.isNumeric(e)?1*s.dataset.id==1*e:s.dataset.id===e;if(s.dataset&&i)return t=s,!0}),t};break;case"selected":n=function(){return o.proxy(this.find(":scope > [selected]"))};break;case"first":n=function(){return o.proxy(this.items[0])};break;case"last":n=function(){return o.proxy(this.items[this.items.length-1])};break;case"pop":n=function(){if(this.items.length){const e=this[0].parentNode;return o.proxy(e.removeChild(this.items[this.items.length-1]))}};break;case"push":n=function(e){if(e instanceof HTMLElement)this.append(e);else if(m2d2.utils.isPlainObject(e)){const t=this.items.length,s=o.getItem(this,t,e);this.appendChild(s)}};break;case"remove":n=function(e){if(this.items.length){const t=this.items.get(e);1===t.length&&t.remove()}};break;case"shift":n=function(){if(this.items.length){const e=this.items[0].parentNode;return o.proxy(e.removeChild(this.items[0]))}};break;case"sort":n=function(e){if(this.items.length){const s=Array.from(this.items);s.sort(e||((e,t)=>e.text.localeCompare(t.text))),t(s)}};break;case"unshift":n=function(e){if(e instanceof HTMLElement)this.prepend(e);else if(m2d2.utils.isPlainObject(e)){const t=this.items.length,s=o.getItem(this,t,e);this.prepend(s)}};break;default:let s=i;switch(!0){case"findAll"===i:s="filter";case"function"==typeof Array.prototype[i]:const t=function(...t){const i=[];return Array.from(e.items).forEach(e=>{i.push(o.proxy(e))}),Array.from(i)[s](...t)};n="find"===i?function(...e){return m2d2.utils.isString(e[0])?this.find(e[0]):t(...e)}:"findAll"===i?function(...e){return 0===e.length?this.findAll():m2d2.utils.isString(e[0])?this.findAll(e[0]):t(...e)}:t}}n&&m2d2.utils.defineProp(s,i,n.bind(e))}})}}
m2d2.load(t=>{function e(e){if(t.exists("#m2d2-alert .m2d2-alert-front")){t("#m2d2-alert .m2d2-alert-front").css.add("vanish"),setTimeout(()=>{t.exists("#m2d2-alert .m2d2-alert-front")&&t("#m2d2-alert").remove(),e&&e()},400)}else e&&e()}function a(t){let e=[];switch(t){case"question":e=["fa","fa-question-circle"];break;case"info":e=["fa","fa-exclamation-circle"];break;case"error":e=["fa","fa-exclamation-triangle"];break;case"ok":e=["fa","fa-check"];break;case"input":e=["fa","fa-edit"];break;case"wait":e=["fa","fa-cog","fa-spin"]}return e}t.message=function(c){if(c&&(t.isFunction(c.callback)||(c.callback&&!c.text&&(c.text=c.callback),c.callback=()=>{}),c.text||(c.text="")),e(()=>{t("body",{m2d2Alert:{tagName:"div",id:"m2d2-alert",back:{tagName:"div",css:"m2d2-alert-back",style:{position:"absolute",left:0,right:0,top:0,bottom:0,backgroundColor:"#0005",display:"flex",justifyContent:"center",alignItems:"center"},front:{tagName:"form",css:(c.css?t.isArray(c.css)?c.css:[c.css]:[]).concat(["m2d2-alert-front","popup",c.icon],a(c.icon)),style:{zIndex:100},message:{tagName:"div",css:"m2d2-alert-title",span:c.title},submsg:(()=>{let e;return e="input"!==c.icon||c.text?t.isPlainObject(c.text)?{fieldset:Object.assign({css:"m2d2-alert-field"},c.text)}:{span:c.text.replace("\n","<br>")}:{fieldset:{css:"m2d2-alert-field",input:{type:"text",name:"answer",onload:function(){this.focus()}}}},Object.assign({tagName:"div",css:"m2d2-alert-text"},e)})(c.icon),onsubmit:function(){const t=this.getData();let a;switch(t.button){case"ok":case"yes":a=()=>{c.callback(!0,t)};break;case"no":a=()=>{c.callback(!1,t)};break;case"cancel":a=()=>{c.callback(null,t)};break;case"send":a=1===Object.keys(t).length?()=>{c.callback(t[Object.keys(t)[0]],t)}:2===Object.keys(t).length?()=>{c.callback(t[Object.keys(t).find(t=>"button"!==t)],t)}:()=>{c.callback(t,t)};break;default:a=()=>{c.callback(t,t)}}return e(a),!1},onload:function(){const t=this.find("[autofocus]");t&&t.focus()}}}}})}),c.buttons.length){const e={buttons:{tagName:"div",css:"m2d2-alert-buttons"}};c.buttons.forEach(a=>{const c=a.toLowerCase().replace(/[^a-z ]/g,"").replace(" ","_");e.buttons[c]={tagName:"button",type:"submit",value:c,css:["color",c],text:void 0!==t.dict?t.dict(a):a,autofocus:["ok","yes"].includes(a),formNoValidate:["cancel"].includes(a),onclick:function(){t(this.closest("form"),{hide:{tagName:"input",type:"hidden",name:"button",value:this.value}})}}}),t("#m2d2-alert .m2d2-alert-front",e)}let s=1;return t("#m2d2-alert .m2d2-alert-front").findAll("input, select, textarea").forEach(t=>{""===t.name&&(t.name="field_"+s++)}),{close:e}},t.wait=(e,a,c)=>t.message({icon:"wait",title:e,buttons:[],text:void 0===c?null:a,callback:void 0===c?a:c}),t.alert=(e,a,c)=>t.message({icon:"info",title:e,buttons:["ok"],text:void 0===c?null:a,callback:void 0===c?a:c}),t.success=(e,a,c)=>t.message({icon:"ok",title:e,buttons:["ok"],text:void 0===c?null:a,callback:void 0===c?a:c}),t.failure=(e,a,c)=>t.message({icon:"error",title:e,buttons:["ok"],text:void 0===c?null:a,callback:void 0===c?a:c}),t.confirm=(e,a,c)=>t.message({icon:"question",title:e,buttons:["yes","no"],text:void 0===c?null:a,callback:void 0===c?a:c}),t.prompt=(e,a,c)=>t.message({icon:"input",title:e,buttons:["cancel","send"],text:void 0===c?null:a,callback:void 0===c?a:c}),t.closeAll=()=>{e()}});
m2d2.load(t=>{let e=localStorage.getItem("m2d2.lang")||""||navigator.language;t.dict=new function(e){const a=function(t,e){if(void 0===t)return"";let n=a.val(t,!0);if(void 0!==e){if("string"==typeof e&&""!==e){const t=(e=e.replace(/;$/,"")).split(";");e={},t.forEach(a=>{const n=t[a].split(":");e[n[0]]=n[1]})}"object"==typeof e&&e.forEach(t=>{let o=e[t]+"";o=a.val(o,!1),n=n.replace(t,o)})}return n};return a.lang=e||"en",a.data={},a.set=function(t){return this.data=t,this},a.has=function(t,e){return void 0===e?void 0!==this.data[t]:void 0!==this.data[t][e]},a.val=function(e,n){if(t.isEmpty(a.data))return console.error("Dictionary is empty. You need to add a dictionary, for example: `$.dict.set({\nsave : { en : 'Save', es : 'Guardar' },\ncancel : { en : 'Cancel', es : 'Cancelar' }\n})`"),"";if(!e)return console.error("No keyword specified."),"";let o=e;if(void 0===n&&(n=!1),e=e.toLowerCase(),this.has(e)){const t=this.lang.split("-")[0];this.has(e,this.lang)?o=this.data[e][this.lang]:this.has(e,t)?o=this.data[e][t]:n&&console.log("Missing translation for lang ["+this.lang+"]: "+e)}else n&&console.log("Missing keyword: "+e);return o},a}(e);const a=[];t.lang=function(e){e&&(t.dict.lang=e,localStorage.setItem("m2d2.lang",t.dict.lang)),t("body").findAll("[lang]").forEach(e=>{let a=e.text;if(a&&!e.classList.contains("notxt")){e.dataset.kw&&(e.dataset.kw=t.lang.getKeyword(a)),e.text=t.dict(e.dataset.kw);const n=e.dataset.kw+"_title";let o=t.dict.has(n)?t.dict(n):"";o&&(e.title=o)}else if(e.title){e.dataset.kw&&(e.dataset.kw=t.lang.getKeyword(a));let n=t.dict(e.dataset.kw);n&&(e.title=n)}else if(e.value){e.dataset.kw&&(e.dataset.kw=t.lang.getKeyword(a));let n=t.dict(e.dataset.kw);n&&(e.value=n)}}),a.forEach(t=>{t(e)})},t.lang.getKeyword=function(t){return t.toLowerCase().trim().replace(/ /g,"_").replace(/[^\w]/g,"").replace(/_$/,"")},Object.defineProperty(t.lang,"onchange",{get(){return this},set(e){t.isFunction(e)?a.push(e):(console.log("Unable to set lang.onchange, because it is not a function: "),console.log(e))}})}),m2d2.ready(t=>{const e=localStorage.getItem("m2d2.lang")||"",a=t("html").lang||t("body").find("[lang]").lang||"en";(e?a!==e:a!==navigator.language.split("-")[0])&&t.lang()});
m2d2.load(t=>{function s(t){switch(t){case"local":window.localStorage&&(this.store=localStorage);break;case"session":window.sessionStorage&&(this.store=sessionStorage)}null==this.store&&(this.store=localStorage),this.set=function(t,s){"string"==typeof s&&(s={$:s}),this.store.setItem(t,JSON.stringify(s))},this.get=function(t){let s;try{s=JSON.parse(this.store.getItem(t))||{}}catch(e){s=this.store.getItem(t)}return void 0!==s.$?s=s.$:0===Object.keys(s).length&&s.constructor===Object&&(s=null),s},this.del=function(t){this.store.removeItem(t)},this.keys=function(){return Object.keys(this.store).sort()},this.clear=function(){this.store.clear()},this.exists=function(t){return this.store.hasOwnProperty(t)},this.log=function(t,s,e){null==e&&(e=10);const o=this.get(t)||[];for(o.push(s);o.length>e;)o.shift();this.set(t,o)}}t.local=new s("local"),t.session=new s("session")});
m2d2.load(t=>{t.ws=new class{request(t){if(t)try{this.webSocket.send(JSON.stringify(t))}catch(t){this.webSocket.onerror(t)}}getSocket(t,e,n){const s=new WebSocket(this.path);return s.onopen=e,s.onclose=n,s.onmessage=e=>{if(e.data)try{t(JSON.parse(e.data))}catch(t){s.onerror(t)}},s.onerror=t=>{console.error("Socket encountered error: ",t?t.message:"Unknown","Closing socket");const e=s||this;1===e.readyState&&e.close()},s}connect(t,e){this.initRequest=t.request||null,this.onConnect=t.connected||(()=>{}),this.onDisconnect=t.disconnected||(()=>{}),this.reconnect=!1!==t.reconnect,this.host=t.host||window.location.hostname,this.secure=!0===t.secure,this.port=t.port||(this.secure?443:80),this.path="ws"+(this.secure?"s":"")+"://"+this.host+":"+this.port+"/"+(t.path||""),this.connected=!1,this.interval=null;const n=t=>{this.connected=!0,this.request(this.initRequest),this.onConnect()},s=t=>{this.connected=!1,this.onDisconnect(),!this.interval&&this.reconnect&&(this.interval=setInterval(()=>{if(this.connected)console.log("Reconnected..."),clearInterval(this.interval),this.interval=null;else try{this.webSocket.close(),console.log("Reconnecting..."),this.webSocket=this.getSocket(e,n,s)}catch(t){}},2e3))};this.webSocket=this.getSocket(e,n,s)}disconnect(){this.reconnect=!1,this.webSocket.close()}}});
m2d2.load(e=>{const o=function(e,o,n,t,s,r){const a=new XMLHttpRequest;if(void 0===r&&(r=!1),void 0===s&&(s=function(e){console.log(e)}),n&&0===Object.entries(n).length&&(n=""),n)if(r)n=JSON.stringify(n);else switch(e.toUpperCase()){case"GET":o+=(-1!==o.indexOf("?")?"&":"?")+Object.keys(n).map(e=>e+"="+n[e]).join("&"),n="";break;default:n=Object.keys(n).map(e=>e+"="+n[e]).join("&")}a.open(e,o,!0),r?a.setRequestHeader("Content-Type","application/json"):a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onerror=function(e){s({type:"Connection",reason:"Connection Refused"})},a.onload=function(){let e={};try{e=a.responseText?JSON.parse(a.responseText):{error:{type:"Unknown",reason:"Unknown Error"}}}catch(o){e.error={type:"Parse Error",reason:o.message}}a.status>=200&&a.status<400?void 0!==t&&t(e):void 0!==s&&("string"==typeof e.error&&(e.error={type:"Exception",reason:e.error}),s(e.error))},a.send(n)},n={};["get","post","put","delete","connect","options","trace","patch"].forEach((function(e){n[e]=function(){let n,t,s,r,a;switch(arguments.length){case 5:"boolean"==typeof arguments[4]?a=arguments[4]:console.log("Passed JSON argument: "+arguments[4]+" is not boolean.");case 4:"function"==typeof arguments[3]?r=arguments[3]:4===arguments.length&&"boolean"==typeof arguments[3]?a=arguments[3]:console.log("Passed argument 4: "+arguments[3]+" is mistaken");case 3:"function"==typeof arguments[2]?"function"==typeof arguments[1]&&arguments.length<5?r=arguments[2]:s=arguments[2]:3===arguments.length&&"boolean"==typeof arguments[2]?a=arguments[2]:console.log("Passed argument 3: "+arguments[2]+" is mistaken");case 2:"object"==typeof arguments[1]||"string"==typeof arguments[1]?t=arguments[1]:"function"==typeof arguments[1]?s=arguments[1]:console.log("Passed argument 2: "+arguments[1]+" is mistaken");case 1:"string"==typeof arguments[0]?n=arguments[0]:Array.isArray(arguments[0])?n=arguments[0].join("/"):console.log("Passed URL: "+arguments[0]+" was not a string.");break;default:console.log("Incorrect number of arguments passed to xhr")}void 0===t&&(t={}),o(e.toUpperCase(),n,t,s,r,a)}})),Object.assign(e,n)});