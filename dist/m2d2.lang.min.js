m2d2.load(t=>{let e=localStorage.getItem("m2d2.lang")||""||navigator.language;t.dict=new function(e){const a=function(t,e){if(void 0===t)return"";let n=a.val(t,!0);if(void 0!==e){if("string"==typeof e&&""!==e){const t=(e=e.replace(/;$/,"")).split(";");e={},t.forEach(a=>{const n=t[a].split(":");e[n[0]]=n[1]})}"object"==typeof e&&e.forEach(t=>{let o=e[t]+"";o=a.val(o,!1),n=n.replace(t,o)})}return n};return a.lang=e||"en",a.data={},a.set=function(t){return this.data=t,this},a.has=function(t,e){return void 0===e?void 0!==this.data[t]:void 0!==this.data[t][e]},a.val=function(e,n){if(t.isEmpty(a.data))return console.error("Dictionary is empty. You need to add a dictionary, for example: `$.dict.set({\nsave : { en : 'Save', es : 'Guardar' },\ncancel : { en : 'Cancel', es : 'Cancelar' }\n})`"),"";if(!e)return console.error("No keyword specified."),"";let o=e;if(void 0===n&&(n=!1),e=e.toLowerCase(),this.has(e)){const t=this.lang.split("-")[0];this.has(e,this.lang)?o=this.data[e][this.lang]:this.has(e,t)?o=this.data[e][t]:n&&console.log("Missing translation for lang ["+this.lang+"]: "+e)}else n&&console.log("Missing keyword: "+e);return o},a}(e);const a=[];t.lang=function(e){e&&(t.dict.lang=e,localStorage.setItem("m2d2.lang",t.dict.lang)),t("body").findAll("[lang]").forEach(e=>{let a=e.text;if(a&&!e.classList.contains("notxt")){e.dataset.kw&&(e.dataset.kw=t.lang.getKeyword(a)),e.text=t.dict(e.dataset.kw);const n=e.dataset.kw+"_title";let o=t.dict.has(n)?t.dict(n):"";o&&(e.title=o)}else if(e.title){e.dataset.kw&&(e.dataset.kw=t.lang.getKeyword(a));let n=t.dict(e.dataset.kw);n&&(e.title=n)}else if(e.value){e.dataset.kw&&(e.dataset.kw=t.lang.getKeyword(a));let n=t.dict(e.dataset.kw);n&&(e.value=n)}}),a.forEach(t=>{t(e)})},t.lang.getKeyword=function(t){return t.toLowerCase().trim().replace(/ /g,"_").replace(/[^\w]/g,"").replace(/_$/,"")},Object.defineProperty(t.lang,"onchange",{get(){return this},set(e){t.isFunction(e)?a.push(e):(console.log("Unable to set lang.onchange, because it is not a function: "),console.log(e))}})}),m2d2.ready(t=>{const e=localStorage.getItem("m2d2.lang")||"",a=t("html").lang||t("body").find("[lang]").lang||"en";(e?a!==e:a!==navigator.language.split("-")[0])&&t.lang()});